<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Bar Chart Test</title>
    <script type="module" src="./packages/core/dist/siemens-ix/siemens-ix.esm.js"></script>
    <link rel="stylesheet" href="./packages/core/dist/siemens-ix/siemens-ix.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
            margin: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1, h2 {
            color: white;
            text-align: center;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
        }
        .card-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed #555;
            border-radius: 8px;
        }
        .expected-bars {
            background: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .expected-row {
            display: flex;
            align-items: center;
            margin: 10px 0;
            gap: 10px;
        }
        .expected-label {
            width: 40px;
            font-size: 12px;
        }
        .expected-bar {
            height: 16px;
            display: inline-block;
        }
        .success { background-color: #01d65a; }
        .warning { background-color: #ffd732; }
        .alarm { background-color: #ff2640; }
        .critical { background-color: #ff9000; }
        .debug-info {
            background: #333;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ç®€åŒ–çš„ Bar Chart æµ‹è¯•</h1>

        <div class="expected-bars">
            <h3>æœŸæœ›æ˜¾ç¤ºçš„æ•ˆæœï¼š</h3>
            <div class="expected-row">
                <span class="expected-label">10.x:</span>
                <div class="expected-bar success" style="width: 60px;"></div>
                <span>60px ç»¿è‰²</span>
            </div>
            <div class="expected-row">
                <span class="expected-label">192.x:</span>
                <div class="expected-bar success" style="width: 100px;"></div>
                <div class="expected-bar alarm" style="width: 20px;"></div>
                <div class="expected-bar critical" style="width: 15px;"></div>
                <span>100px ç»¿è‰² + 20px çº¢è‰² + 15px æ©™è‰²</span>
            </div>
            <div class="expected-row">
                <span class="expected-label">172.x:</span>
                <div class="expected-bar success" style="width: 80px;"></div>
                <div class="expected-bar warning" style="width: 30px;"></div>
                <span>80px ç»¿è‰² + 30px é»„è‰²</span>
            </div>
        </div>

        <div class="test-section">
            <h2>å®é™…ç»„ä»¶æ˜¾ç¤º</h2>
            <div class="card-container">
                <ix-custom-card id="test-card"></ix-custom-card>
            </div>
        </div>

        <div class="test-section">
            <h2>æ£€æŸ¥ç»“æœ</h2>
            <div class="debug-info" id="check-results">
                æ£€æŸ¥ä¸­...
            </div>
        </div>
    </div>

    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('=== Simple Bar Chart Test ===');

                const card = document.getElementById('test-card');
                const checkResults = document.getElementById('check-results');

                if (!card || !card.shadowRoot) {
                    checkResults.textContent = 'âŒ ç»„ä»¶æœªæ‰¾åˆ°æˆ– Shadow DOM ä¸å¯ç”¨';
                    return;
                }

                const shadowRoot = card.shadowRoot;
                let results = [];

                // æ£€æŸ¥æ–°çš„ç»“æ„
                const barChart = shadowRoot.querySelector('.bar-chart');
                const chartRows = shadowRoot.querySelectorAll('.chart-row');
                const barSuccess = shadowRoot.querySelectorAll('.bar-success');
                const barWarning = shadowRoot.querySelectorAll('.bar-warning');
                const barAlarm = shadowRoot.querySelectorAll('.bar-alarm');
                const barCritical = shadowRoot.querySelectorAll('.bar-critical');

                results.push(`bar-chart å®¹å™¨: ${barChart ? 'âœ… å­˜åœ¨' : 'âŒ ç¼ºå¤±'}`);
                results.push(`chart-row è¡Œæ•°: ${chartRows.length}/3 ${chartRows.length === 3 ? 'âœ…' : 'âŒ'}`);
                results.push(`success bars: ${barSuccess.length} ä¸ª`);
                results.push(`warning bars: ${barWarning.length} ä¸ª`);
                results.push(`alarm bars: ${barAlarm.length} ä¸ª`);
                results.push(`critical bars: ${barCritical.length} ä¸ª`);

                // æ£€æŸ¥æ¯ä¸ª bar çš„å¯è§æ€§
                let visibleBars = 0;
                const allBars = [
                    ...barSuccess,
                    ...barWarning,
                    ...barAlarm,
                    ...barCritical
                ];

                allBars.forEach((bar, index) => {
                    const style = window.getComputedStyle(bar);
                    const hasWidth = parseInt(style.width) > 0;
                    const hasHeight = parseInt(style.height) > 0;
                    const hasBackground = style.backgroundColor !== 'rgba(0, 0, 0, 0)' &&
                                        style.backgroundColor !== 'transparent';

                    if (hasWidth && hasHeight && hasBackground) {
                        visibleBars++;
                    }

                    console.log(`Bar ${index + 1} (${bar.className}):`, {
                        width: style.width,
                        height: style.height,
                        backgroundColor: style.backgroundColor,
                        display: style.display,
                        opacity: style.opacity
                    });
                });

                results.push(`å¯è§çš„ bars: ${visibleBars}/${allBars.length} ä¸ª ${visibleBars > 0 ? 'âœ…' : 'âŒ'}`);

                // æ£€æŸ¥ç½‘æ ¼çº¿
                const verticalLines = shadowRoot.querySelectorAll('.v-line');
                const horizontalLines = shadowRoot.querySelectorAll('.h-line');

                results.push(`å‚ç›´ç½‘æ ¼çº¿: ${verticalLines.length}/7 ${verticalLines.length === 7 ? 'âœ…' : 'âŒ'}`);
                results.push(`æ°´å¹³ç½‘æ ¼çº¿: ${horizontalLines.length}/4 ${horizontalLines.length === 4 ? 'âœ…' : 'âŒ'}`);

                // æ˜¾ç¤ºç»“æœ
                checkResults.innerHTML = results.join('<br>');

                // æ€»ç»“
                if (visibleBars > 0) {
                    checkResults.innerHTML += '<br><br>ğŸ‰ <strong>æˆåŠŸï¼Bar Chart ç°åœ¨å¯è§äº†ï¼</strong>';
                } else {
                    checkResults.innerHTML += '<br><br>âŒ <strong>ä»ç„¶æœ‰é—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒè¯•</strong>';
                }

                console.log('Simple Bar Test Results:', {
                    barChart: !!barChart,
                    chartRows: chartRows.length,
                    totalBars: allBars.length,
                    visibleBars: visibleBars,
                    verticalLines: verticalLines.length,
                    horizontalLines: horizontalLines.length
                });
            }, 2000);
        });
    </script>
</body>
</html>
