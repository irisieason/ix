<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Lines Test</title>
    <script type="module" src="./packages/core/dist/siemens-ix/siemens-ix.esm.js"></script>
    <link rel="stylesheet" href="./packages/core/dist/siemens-ix/siemens-ix.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
            margin: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
        }
        .card-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .grid-info {
            background: #333;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 20px 0;
        }
        .comparison {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            margin: 20px 0;
        }
        .figma-reference {
            flex: 1;
            background: #444;
            padding: 15px;
            border-radius: 4px;
        }
        .current-implementation {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>网格线数量验证测试</h1>

        <div class="grid-info">
            <strong>根据 Figma 设计稿分析：</strong><br>
            • <strong>X轴（垂直线）</strong>：7条线对应刻度 0, 3, 6, 9, 12, 15, 18<br>
            • <strong>Y轴（水平线）</strong>：4条线（3行数据 + 顶部/底部边界）<br>
            • <strong>数据行</strong>：10.x, 192.x, 172.x（3行）<br>
            • <strong>柱状图</strong>：绿色(成功)、黄色(警告)、红色(报警)、橙色(严重)
        </div>

        <div class="test-section">
            <h2>当前实现</h2>
            <div class="card-container">
                <ix-custom-card></ix-custom-card>
            </div>
        </div>

        <div class="comparison">
            <div class="figma-reference">
                <h3>Figma 设计稿要求</h3>
                <ul>
                    <li>✅ 7条垂直网格线</li>
                    <li>✅ 4条水平网格线</li>
                    <li>✅ 3行IP数据（10.x, 192.x, 172.x）</li>
                    <li>✅ X轴刻度：0, 3, 6, 9, 12, 15, 18</li>
                    <li>✅ 彩色柱状图</li>
                    <li>✅ 图例（4种颜色）</li>
                    <li>✅ 导航按钮</li>
                </ul>
            </div>
            <div class="current-implementation">
                <h3>当前实现检查</h3>
                <div id="implementation-check">
                    检查中...
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>详细检查</h2>
            <div id="detailed-check" style="font-family: monospace; font-size: 12px;">
                加载中...
            </div>
        </div>
    </div>

    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('=== Grid Lines Test ===');

                const card = document.querySelector('ix-custom-card');
                if (!card) {
                    document.getElementById('implementation-check').innerHTML = '❌ 组件未找到';
                    return;
                }

                // 检查组件内部结构
                const shadowRoot = card.shadowRoot;
                if (!shadowRoot) {
                    document.getElementById('implementation-check').innerHTML = '❌ Shadow DOM 未找到';
                    return;
                }

                // 检查垂直网格线
                const verticalLines = shadowRoot.querySelectorAll('.grid-line');
                const horizontalLines = shadowRoot.querySelectorAll('.horizontal-grid-line');
                const bottomLine = shadowRoot.querySelectorAll('.bottom-horizontal-line');
                const yLabels = shadowRoot.querySelectorAll('.y-label');
                const xTicks = shadowRoot.querySelectorAll('.x-tick');
                const bars = shadowRoot.querySelectorAll('.bar');
                const legendItems = shadowRoot.querySelectorAll('.legend-item');

                const checkResults = [
                    `垂直网格线: ${verticalLines.length}/7 ${verticalLines.length === 7 ? '✅' : '❌'}`,
                    `水平网格线: ${horizontalLines.length + bottomLine.length}/4 ${(horizontalLines.length + bottomLine.length) === 4 ? '✅' : '❌'}`,
                    `Y轴标签: ${yLabels.length}/3 ${yLabels.length === 3 ? '✅' : '❌'}`,
                    `X轴刻度: ${xTicks.length}/7 ${xTicks.length === 7 ? '✅' : '❌'}`,
                    `柱状图: ${bars.length} 个 ${bars.length > 0 ? '✅' : '❌'}`,
                    `图例项: ${legendItems.length}/4 ${legendItems.length === 4 ? '✅' : '❌'}`
                ];

                document.getElementById('implementation-check').innerHTML =
                    '<ul><li>' + checkResults.join('</li><li>') + '</li></ul>';

                // 详细检查
                const detailedInfo = [
                    '=== 组件结构分析 ===',
                    `垂直网格线数量: ${verticalLines.length}`,
                    `水平网格线数量: ${horizontalLines.length}`,
                    `底部水平线数量: ${bottomLine.length}`,
                    `总水平线数量: ${horizontalLines.length + bottomLine.length}`,
                    '',
                    '=== Y轴标签 ===',
                    ...Array.from(yLabels).map((label, i) => `${i + 1}. ${label.textContent}`),
                    '',
                    '=== X轴刻度 ===',
                    ...Array.from(xTicks).map((tick, i) => `${i + 1}. ${tick.textContent}`),
                    '',
                    '=== 柱状图 ===',
                    ...Array.from(bars).map((bar, i) => {
                        const classes = Array.from(bar.classList);
                        const width = bar.style.width || '未设置';
                        return `${i + 1}. ${classes.join(' ')} - 宽度: ${width}`;
                    }),
                    '',
                    '=== 图例 ===',
                    ...Array.from(legendItems).map((item, i) => {
                        const colorDiv = item.querySelector('.legend-color');
                        const text = item.querySelector('ix-typography');
                        const colorClass = colorDiv ? Array.from(colorDiv.classList).find(c => c !== 'legend-color') : '未知';
                        return `${i + 1}. ${colorClass} - ${text ? text.textContent : '无文字'}`;
                    })
                ];

                document.getElementById('detailed-check').innerHTML =
                    detailedInfo.join('<br>');

                console.log('Grid lines check:', {
                    verticalLines: verticalLines.length,
                    horizontalLines: horizontalLines.length,
                    bottomLine: bottomLine.length,
                    totalHorizontalLines: horizontalLines.length + bottomLine.length,
                    yLabels: yLabels.length,
                    xTicks: xTicks.length,
                    bars: bars.length,
                    legendItems: legendItems.length
                });
            }, 2000);
        });
    </script>
</body>
</html>
