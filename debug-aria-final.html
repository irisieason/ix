<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final ARIA Debug</title>
    <script type="module" src="packages/core/dist/siemens-ix/siemens-ix.esm.js"></script>
    <link rel="stylesheet" href="packages/core/dist/siemens-ix/siemens-ix.css">
</head>
<body>
    <h1>Final ARIA Label Debug</h1>

    <div style="margin: 20px 0;">
        <input type="text" id="aria-input" value="My Custom ARIA Label" placeholder="è¾“å…¥æ–°çš„ARIA Label" />
        <button onclick="updateAndCheck()">æ›´æ–°å¹¶æ£€æŸ¥</button>
    </div>

    <h2>EventItemContent ç»„ä»¶æµ‹è¯•</h2>
    <div style="width: 800px; border: 1px solid #ccc; margin: 20px 0;">
        <ix-event-item-content
            id="test-component"
            type-icon="info"
            type-header="ARIA æµ‹è¯•"
            header-info="æµ‹è¯• ariaLabelButton å±æ€§"
            device-name="test-device"
            device-info="192.168.1.1"
            datestamp="2026-01-05"
            timestamp="08:51:21"
            variant="primary"
            aria-label-button="Initial ARIA Label"
            button-text="æµ‹è¯•æŒ‰é’®">
        </ix-event-item-content>
    </div>

    <div id="result" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px;"></div>

    <script>
        let component;

        document.addEventListener('DOMContentLoaded', function() {
            component = document.getElementById('test-component');

            // è®¾ç½® instance å±æ€§
            component.instance = {
                iXIcons: {
                    icon: {
                        name: 'share'
                    }
                }
            };

            // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿ç»„ä»¶å®Œå…¨æ¸²æŸ“
            setTimeout(() => {
                checkAriaLabel();
            }, 3000);
        });

        function updateAndCheck() {
            const newAriaLabel = document.getElementById('aria-input').value;

            console.log('=== æ›´æ–° ARIA Label ===');
            console.log('æ–°å€¼:', newAriaLabel);

            // æ–¹æ³•1: è®¾ç½® HTML å±æ€§
            component.setAttribute('aria-label-button', newAriaLabel);

            // æ–¹æ³•2: è®¾ç½® JavaScript å±æ€§
            component.ariaLabelButton = newAriaLabel;

            console.log('HTML å±æ€§è®¾ç½®å®Œæˆ');
            console.log('JS å±æ€§è®¾ç½®å®Œæˆ');

            // å»¶è¿Ÿæ£€æŸ¥ç»“æœ
            setTimeout(() => {
                checkAriaLabel();
            }, 1000);
        }

        function checkAriaLabel() {
            const resultDiv = document.getElementById('result');

            try {
                // æ£€æŸ¥ EventItemContent ç»„ä»¶
                const htmlAttr = component.getAttribute('aria-label-button');
                const jsProperty = component.ariaLabelButton;

                console.log('=== EventItemContent æ£€æŸ¥ ===');
                console.log('HTML å±æ€§:', htmlAttr);
                console.log('JS å±æ€§:', jsProperty);

                if (!component.shadowRoot) {
                    resultDiv.innerHTML = 'âŒ æ— æ³•è®¿é—® EventItemContent çš„ shadow DOM';
                    return;
                }

                // æ£€æŸ¥ ix-button ç»„ä»¶
                const ixButton = component.shadowRoot.querySelector('ix-button');
                if (!ixButton) {
                    resultDiv.innerHTML = 'âŒ æ‰¾ä¸åˆ° ix-button å…ƒç´ ';
                    return;
                }

                const ixButtonAriaLabel = ixButton.ariaLabelButton;
                console.log('=== ix-button æ£€æŸ¥ ===');
                console.log('ix-button ariaLabelButton å±æ€§:', ixButtonAriaLabel);

                if (!ixButton.shadowRoot) {
                    resultDiv.innerHTML = 'âŒ æ— æ³•è®¿é—® ix-button çš„ shadow DOM';
                    return;
                }

                // æ£€æŸ¥å®é™…çš„ HTML button å…ƒç´ 
                const actualButton = ixButton.shadowRoot.querySelector('button');
                if (!actualButton) {
                    resultDiv.innerHTML = 'âŒ æ‰¾ä¸åˆ°å®é™…çš„ button å…ƒç´ ';
                    return;
                }

                const finalAriaLabel = actualButton.getAttribute('aria-label');
                console.log('=== æœ€ç»ˆ HTML button æ£€æŸ¥ ===');
                console.log('æœ€ç»ˆ aria-label:', finalAriaLabel);

                // æ˜¾ç¤ºç»“æœ
                resultDiv.innerHTML = `
                    <h3>ğŸ” ARIA Label æ£€æŸ¥ç»“æœ</h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="background: #e9ecef;">
                            <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">å±‚çº§</th>
                            <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">å±æ€§/å€¼</th>
                            <th style="padding: 8px; border: 1px solid #dee2e6; text-align: left;">ç»“æœ</th>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">EventItemContent HTML</td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">aria-label-button="${htmlAttr || 'undefined'}"</td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">${htmlAttr ? 'âœ…' : 'âŒ'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">EventItemContent JS</td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">ariaLabelButton="${jsProperty || 'undefined'}"</td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">${jsProperty ? 'âœ…' : 'âŒ'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">ix-button</td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">ariaLabelButton="${ixButtonAriaLabel || 'undefined'}"</td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;">${ixButtonAriaLabel ? 'âœ…' : 'âŒ'}</td>
                        </tr>
                        <tr style="background: #fff3cd;">
                            <td style="padding: 8px; border: 1px solid #dee2e6;"><strong>æœ€ç»ˆ HTML button</strong></td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;"><strong>aria-label="${finalAriaLabel || 'undefined'}"</strong></td>
                            <td style="padding: 8px; border: 1px solid #dee2e6;"><strong>${finalAriaLabel ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'}</strong></td>
                        </tr>
                    </table>
                    <p style="margin-top: 15px;">
                        <strong>æ€»ç»“:</strong> ${finalAriaLabel ?
                            `âœ… ARIA Label æ­£å¸¸å·¥ä½œï¼æœ€ç»ˆå€¼ä¸º "${finalAriaLabel}"` :
                            'âŒ ARIA Label æœªæ­£ç¡®ä¼ é€’åˆ°æœ€ç»ˆçš„ button å…ƒç´ '
                        }
                    </p>
                `;

            } catch (error) {
                console.error('æ£€æŸ¥è¿‡ç¨‹ä¸­å‡ºé”™:', error);
                resultDiv.innerHTML = `âŒ æ£€æŸ¥è¿‡ç¨‹ä¸­å‡ºé”™: ${error.message}`;
            }
        }
    </script>
</body>
</html>
