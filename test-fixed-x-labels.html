<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed X-axis Labels Test</title>
    <script type="module" src="./packages/core/dist/siemens-ix/siemens-ix.esm.js"></script>
    <link rel="stylesheet" href="./packages/core/dist/siemens-ix/siemens-ix.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
        }
        .test-container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .test-title {
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>StatusHistoryChart X-axis Label Alignment Fix</h1>

    <div class="test-container">
        <div class="test-title">Test 1: Default 6 months (Jan-Jun)</div>
        <ix-card>
            <ix-card-content>
                <ix-status-history-chart
                    chart-title="Status history"
                    data='{"Jan": {"online": 10, "maintenance": 0, "error": 0, "offline": -100}, "Feb": {"online": 5, "maintenance": -5, "error": 0, "offline": -40}, "Mar": {"online": -10, "maintenance": -60, "error": -20, "offline": -40}, "Apr": {"online": -25, "maintenance": -40, "error": -25, "offline": -80}, "May": {"online": 0, "maintenance": 0, "error": 0, "offline": -40}, "Jun": {"online": 0, "maintenance": 0, "error": 0, "offline": -40}}'>
                </ix-status-history-chart>
            </ix-card-content>
        </ix-card>
    </div>

    <div class="test-container">
        <div class="test-title">Test 2: 3 months (Q1-Q3)</div>
        <ix-card>
            <ix-card-content>
                <ix-status-history-chart
                    chart-title="Quarterly trends"
                    data='{"Q1": {"online": 15, "maintenance": -10, "error": -5, "offline": -80}, "Q2": {"online": 8, "maintenance": -20, "error": -15, "offline": -60}, "Q3": {"online": -5, "maintenance": -35, "error": -30, "offline": -45}}'>
                </ix-status-history-chart>
            </ix-card-content>
        </ix-card>
    </div>

    <div class="test-container">
        <div class="test-title">Test 3: 2 data points (Start-End)</div>
        <ix-card>
            <ix-card-content>
                <ix-status-history-chart
                    chart-title="Simple trend"
                    data='{"Start": {"online": 0, "maintenance": 0, "error": 0, "offline": -50}, "End": {"online": 5, "maintenance": -5, "error": -2, "offline": -30}}'>
                </ix-status-history-chart>
            </ix-card-content>
        </ix-card>
    </div>

    <div class="test-container">
        <div class="test-title">Test 4: Extended timeline (12 months)</div>
        <ix-card>
            <ix-card-content>
                <ix-status-history-chart
                    chart-title="Full year performance"
                    data='{"Jan": {"online": 10, "maintenance": 0, "error": 0, "offline": -100}, "Feb": {"online": 5, "maintenance": -5, "error": 0, "offline": -40}, "Mar": {"online": -10, "maintenance": -60, "error": -20, "offline": -40}, "Apr": {"online": -25, "maintenance": -40, "error": -25, "offline": -80}, "May": {"online": 0, "maintenance": 0, "error": 0, "offline": -40}, "Jun": {"online": 0, "maintenance": 0, "error": 0, "offline": -40}, "Jul": {"online": 5, "maintenance": -10, "error": -5, "offline": -50}, "Aug": {"online": 8, "maintenance": -5, "error": -3, "offline": -45}, "Sep": {"online": 3, "maintenance": -15, "error": -8, "offline": -55}, "Oct": {"online": -5, "maintenance": -25, "error": -15, "offline": -65}, "Nov": {"online": 2, "maintenance": -8, "error": -5, "offline": -48}, "Dec": {"online": 7, "maintenance": -3, "error": -2, "offline": -42}}'>
                </ix-status-history-chart>
            </ix-card-content>
        </ix-card>
    </div>

    <div class="test-container">
        <div class="test-title">Test 5: Chinese labels (一月-六月)</div>
        <ix-card>
            <ix-card-content>
                <ix-status-history-chart
                    chart-title="系统状态历史"
                    data='{"一月": {"online": 10, "maintenance": 0, "error": -5, "offline": -80}, "二月": {"online": 5, "maintenance": -10, "error": -8, "offline": -60}, "三月": {"online": -5, "maintenance": -30, "error": -20, "offline": -50}, "四月": {"online": 0, "maintenance": -20, "error": -10, "offline": -70}, "五月": {"online": 8, "maintenance": -5, "error": -3, "offline": -40}, "六月": {"online": 12, "maintenance": 0, "error": -2, "offline": -35}}'>
                </ix-status-history-chart>
            </ix-card-content>
        </ix-card>
    </div>

    <script>
        // Add some debugging to verify the alignment
        setTimeout(() => {
            console.log('=== X-axis Label Alignment Debug ===');

            document.querySelectorAll('ix-status-history-chart').forEach((chart, chartIndex) => {
                console.log(`\nChart ${chartIndex + 1}:`);

                if (chart.shadowRoot) {
                    const xLabels = chart.shadowRoot.querySelectorAll('.x-label');
                    const verticalLines = chart.shadowRoot.querySelectorAll('.grid-lines line[x1]');
                    const chartSvg = chart.shadowRoot.querySelector('.chart-svg-container');

                    if (chartSvg) {
                        const svgRect = chartSvg.getBoundingClientRect();

                        xLabels.forEach((label, index) => {
                            const labelRect = label.getBoundingClientRect();
                            const labelCenter = labelRect.left + labelRect.width / 2;
                            const labelText = label.textContent?.trim();

                            // Get corresponding vertical line position
                            if (verticalLines[index]) {
                                const x1 = parseFloat(verticalLines[index].getAttribute('x1'));
                                const gridLineX = svgRect.left + x1;
                                const offset = Math.abs(labelCenter - gridLineX);

                                console.log(`  Label "${labelText}": center=${labelCenter.toFixed(1)}, gridLine=${gridLineX.toFixed(1)}, offset=${offset.toFixed(1)}px`);
                            }
                        });
                    }
                }
            });
        }, 1000);
    </script>
</body>
</html>
