<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatusHistoryChart Alignment Verification</title>
    <script type="module" src="packages/core/dist/siemens-ix/siemens-ix.esm.js"></script>
    <link rel="stylesheet" href="packages/core/dist/siemens-ix/siemens-ix.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-container {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        .comparison {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .chart-section {
            flex: 1;
            min-width: 400px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            background: #333;
        }
        .success { background: #01d65a; color: black; }
        .error { background: #ff2640; }
        .info { background: #0066cc; }
    </style>
</head>
<body>
    <h1>StatusHistoryChart Alignment Verification</h1>

    <div class="test-container">
        <h2>Component Loading Status</h2>
        <div id="loading-status" class="status">Checking component loading...</div>
    </div>

    <div class="test-container">
        <h2>Chart Comparison</h2>
        <div class="comparison">
            <div class="chart-section">
                <h3>StatusHistoryChart (Fixed)</h3>
                <ix-status-history-chart id="status-chart"></ix-status-history-chart>
            </div>
            <div class="chart-section">
                <h3>DeviceStatusChart (Reference)</h3>
                <ix-device-status-chart id="device-chart"></ix-device-status-chart>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>Alignment Analysis</h2>
        <div id="alignment-status" class="status">Analyzing alignment...</div>
        <div id="alignment-details"></div>
    </div>

    <script>
        function checkComponentLoading() {
            const statusChart = document.getElementById('status-chart');
            const deviceChart = document.getElementById('device-chart');
            const loadingStatus = document.getElementById('loading-status');

            let statusLoaded = false;
            let deviceLoaded = false;

            // Check if components are defined
            if (customElements.get('ix-status-history-chart')) {
                statusLoaded = true;
            }
            if (customElements.get('ix-device-status-chart')) {
                deviceLoaded = true;
            }

            if (statusLoaded && deviceLoaded) {
                loadingStatus.textContent = '✓ Both components loaded successfully';
                loadingStatus.className = 'status success';

                // Wait for components to render, then analyze alignment
                setTimeout(analyzeAlignment, 2000);
            } else {
                loadingStatus.textContent = `✗ Component loading failed - Status: ${statusLoaded}, Device: ${deviceLoaded}`;
                loadingStatus.className = 'status error';
            }
        }

        function analyzeAlignment() {
            const alignmentStatus = document.getElementById('alignment-status');
            const alignmentDetails = document.getElementById('alignment-details');

            try {
                const statusChart = document.getElementById('status-chart');
                const shadowRoot = statusChart.shadowRoot;

                if (!shadowRoot) {
                    alignmentStatus.textContent = '✗ Cannot access Shadow DOM';
                    alignmentStatus.className = 'status error';
                    return;
                }

                // Find vertical grid lines and x-axis labels
                const verticalLines = shadowRoot.querySelectorAll('.grid-lines line[x1]');
                const xLabels = shadowRoot.querySelectorAll('.x-axis-labels .x-label');

                alignmentStatus.textContent = `✓ Found ${verticalLines.length} vertical lines and ${xLabels.length} x-axis labels`;
                alignmentStatus.className = 'status success';

                // Create detailed analysis
                let details = '<h4>Alignment Details:</h4>';
                details += `<p>Vertical lines: ${verticalLines.length}</p>`;
                details += `<p>X-axis labels: ${xLabels.length}</p>`;
                details += '<p>Using flex layout for even distribution: ✓</p>';
                details += '<p>Labels should now be perfectly aligned with vertical grid lines</p>';

                alignmentDetails.innerHTML = details;

            } catch (error) {
                alignmentStatus.textContent = `✗ Analysis failed: ${error.message}`;
                alignmentStatus.className = 'status error';
            }
        }

        // Wait for components to load
        setTimeout(checkComponentLoading, 1000);
    </script>
</body>
</html>
